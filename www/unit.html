<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Cubby - アクションのテスト</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          <meta name="author" content="agata" />
          </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
    
            Cubby
    
            </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
          
                <a href="http://www.seasar.org/" class="externalLink">The Seasar Project</a>
                &gt;
      
                <a href="index.html">Cubby Project</a>
                  </div>
            <div class="xright">      
  

  
    
  
  
    
             最終更新: 2008-02-19
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>ドキュメント</h5>
            <ul>
              
    <li class="none">
                    <a href="index.html">Cubbyについて</a>
          </li>
              
    <li class="none">
                    <a href="setup.html">セットアップ</a>
          </li>
              
    <li class="none">
                    <a href="twominute.html">2分間チュートリアル</a>
          </li>
              
    <li class="none">
                    <a href="fiveminute.html">5分間チュートリアル</a>
          </li>
              
    <li class="none">
                    <a href="download.html">ダウンロード</a>
          </li>
          </ul>
              <h5>リファレンス</h5>
            <ul>
              
    <li class="none">
                    <a href="action.html">アクション</a>
          </li>
              
    <li class="none">
                    <a href="validation.html">バリデーション</a>
          </li>
              
    <li class="none">
                    <a href="jsp.html">JSP</a>
          </li>
              
    <li class="none">
                    <a href="tags.html">カスタムタグ</a>
          </li>
              
    <li class="none">
                    <a href="functions.html">ファンクション</a>
          </li>
              
    <li class="none">
                    <a href="messages.html">メッセージリソース</a>
          </li>
              
    <li class="none">
              <strong>アクションのテスト</strong>
        </li>
              
    <li class="none">
                    <a href="mayaa.html">Cubby&Mayaa</a>
          </li>
              
    <li class="none">
                    <a href="tips.html">Tips集</a>
          </li>
              
    <li class="none">
                    <a href="cubby/apidocs/index.html">JavaDoc</a>
          </li>
          </ul>
              <h5>リソース</h5>
            <ul>
              
    <li class="none">
                    <a href="presentation.html">プレゼン資料</a>
          </li>
              
    <li class="none">
                    <a href="mail-lists.html">メーリングリスト</a>
          </li>
              
    <li class="none">
                    <a href="issue-tracking.html">課題(JIRA)</a>
          </li>
              
    <li class="none">
                    <a href="source-repository.html">SVNリポジトリ</a>
          </li>
          </ul>
              <h5>プロジェクト文書</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-info.html">プロジェクト情報</a>
                </li>
              
                
              
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-reports.html">プロジェクトレポート</a>
                </li>
          </ul>
              <h5>モジュール</h5>
            <ul>
              
    <li class="none">
                    <a href="cubby/index.html">Cubby</a>
          </li>
              
    <li class="none">
                    <a href="cubby-archetype/index.html">Cubby Archetype</a>
          </li>
              
    <li class="none">
                    <a href="cubby-tomcat55-support/index.html">Cubby Tomcat5.5 Support</a>
          </li>
              
    <li class="none">
                    <a href="cubby-skin/index.html">Cubby Skin</a>
          </li>
              
    <li class="none">
                    <a href="index.html">Cubby Distribution</a>
          </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
          <a href="http://www.seasar.org/" title"Seasar" class="poweredBy">
            <img alt="Seasar.org" src="http://www.seasar.org/images/seasar_banner.gif">
          </a>
                       
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>アクションのテスト</h2>
<p>アクションの単体テストは<a href="cubby/apidocs/org/seasar/cubby/unit/CubbyTestCase.html">CubbyTestCase</a>
を使用します。 SeasarのS2Unitの機能を全て使用できるので <a href="http://s2container.seasar.org/2.4/ja/S2Unit.html" class="externalLink">SeasarのS2Unitのドキュメント</a>
も合わせてご覧ください。</p>
<ol type="1"><li>CubbyTestCaseを継承して、XXXXTest作成します。 </li>
<li>テスト対象のアクションをフィールドに用意します。これはアクション実行後に結果を取得するためです。</li>
<li>アクションのメソッドごとにテストメソッドを書きます。メソッド名はtestから始めます。</li>
<li>テストメソッドの先頭で、パラメータのセットなど初期化処理を行います。</li>
<li><a href="cubby/apidocs/org/seasar/cubby/unit/CubbyTestCase.html#processAction(java.lang.String)">CubbyTestCase#processAction</a>
にリクエストのパスを指定して、アクションメソッドを実行します。CoolURI(パラメータ付きのURI)の場合、パスにパラメータを含んで実行します(TodoActionTest#)。</li>
<li>戻り値を<a href="cubby/apidocs/org/seasar/cubby/unit/CubbyTestCase.html#assertPathEquals(java.lang.Class,java.lang.String,org.seasar.cubby.action.ActionResult)">CubbyTestCase#processAction</a>
で結果のActionResultの型とパスをチェックします。パスのチェックはForwardとRedirectの場合のみ行われます。</li>
<li>必要に応じてアクションクラスのフィールドやリクエストやセッションの値をチェックします。<p><b>HelloActionTest.java</b>
</p>
<div class="source"><pre>package org.seasar.cubby.examples.other.web.hello;

import org.seasar.cubby.action.ActionResult;
import org.seasar.cubby.action.Forward;
import org.seasar.cubby.unit.CubbyTestCase;

public class HelloActionTest extends CubbyTestCase {

        // 対象のアクション
        private HelloAction action;
        
        // 初期化処理
    protected void setUp() throws Exception {
        // diconファイルの読み込み
        include(&quot;app.dicon&quot;);
    }
    
        public void testIndex() throws Exception {
                // アクションの実行
                ActionResult result = processAction(&quot;/hello/&quot;);
                // 結果のチェック
                assertPathEquals(Forward.class, &quot;input.jsp&quot;, result);
        }
        
        public void testMessage() throws Exception {
            // リクエストパラメータのセット
                getRequest().addParameter(&quot;name&quot;, &quot;name1&quot;);
                // アクションの実行
                ActionResult result = processAction(&quot;/hello/message&quot;);
                // 結果のチェック
                assertPathEquals(Forward.class, &quot;result.jsp&quot;, result);
                // 実行後のアクションの状態を確認
                assertEquals(&quot;name1&quot;, action.name);
        }       
}</pre>
</div>
<p><b>HelloActionTest.java</b>
</p>
<div class="source"><pre>package org.seasar.cubby.examples.todo.action;

import org.seasar.cubby.action.ActionResult;
import org.seasar.cubby.action.Forward;
import org.seasar.cubby.action.Redirect;
import org.seasar.cubby.examples.RunDdlServletRequestListener;
import org.seasar.cubby.unit.CubbyTestCase;

public class TodoActionTest extends CubbyTestCase {

        private TodoAction action;
        
    protected void setUp() throws Exception {
        include(&quot;app.dicon&quot;);
        RunDdlServletRequestListener listener = new RunDdlServletRequestListener();
        listener.requestInitialized(null);
    }

    @Override
    protected void setUpAfterBindFields() throws Throwable {
        super.setUpAfterBindFields();
                getRequest().addParameter(&quot;userId&quot;, &quot;test&quot;);
                getRequest().addParameter(&quot;password&quot;, &quot;test&quot;);
                // 後続のテストを実行するためにログインアクションを実行
                assertPathEquals(Redirect.class, &quot;/todo/&quot;, processAction(&quot;/todo/login/process&quot;));
    }
    
        public void testShow() throws Exception {
        this.readXlsAllReplaceDb(&quot;TodoActionTest_PREPARE.xls&quot;);
        // CoolURIの場合のテスト
                ActionResult result = processAction(&quot;/todo/1&quot;);
                assertPathEquals(Forward.class, &quot;show.jsp&quot;, result);
                assertEquals(new Integer(1), action.id);
                assertEquals(&quot;todo1&quot;, action.text);
                assertEquals(&quot;todo1 memo&quot;, action.memo);
                assertEquals(new Integer(1), action.todoType.getId());
                assertEquals(&quot;type1&quot;, action.todoType.getName());
                assertEquals(&quot;2008-01-01&quot;, action.limitDate);
        }
}</pre>
</div>
</li>
</ol>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;      Copyright
    
          2006-2008
    
          The Seasar Foundation and the others. All rights reserved.
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
